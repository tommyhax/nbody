<html>
  <body>
    <canvas id="canvas"></canvas>
    <p>
      <div>
        <table>
          <tr><td><strong>Grid size</strong></td><td><span id="grid"></span> AU</td></tr>
          <tr><td><strong>Elapsed time</strong></td><td><span id="time"></span> years</td></tr>
          <tr><td><strong>Kinetic energy</strong></td><td id="kinetic"></td></tr>
          <tr><td><strong>Potential energy</strong></td><td id="potential"></td></tr>
          <tr><td><strong>Total energy</strong></td><td id="total"></td></tr>
          <tr><td><button onclick="restart()">Restart</button></td></tr>
        </table>
      </div>
    </p>
    <script src="assets/js/extensions.js"></script>
    <script src="assets/js/particle.js"></script>
    <script src="assets/js/random.js"></script>
    <script src="assets/js/system.js"></script>
    <script src="assets/js/vector.js"></script>
    <script>
const N = 3;
const averageMassSM = 1;
const systemRadiusAU = 5;
const e2 = 1e-2;
const dt = 0.001;
const canvasSize = 756;
const gridAU = 1;

const canvas = document.getElementById('canvas');
canvas.width = canvasSize;
canvas.height = canvasSize * 2 / 3;

const ctx = canvas.getContext('2d');
ctx.fillStyle = 'black';
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.translate(canvas.width / 2, canvas.height / 2);

let system, time, animationFrame;

function initSystem() {
    system = new System(N, averageMassSM, systemRadiusAU, e2);
    time = 0;
}

function animate() {
    system.update(dt);
    system.render(ctx, gridAU);
    time += dt;
    updateInfo();
    animationFrame = requestAnimationFrame(animate);
}

function restart() {
    if (animationFrame) {
        cancelAnimationFrame(animationFrame);
    }

    start();
}

function updateInfo () {
    document.getElementById('grid').innerHTML = gridAU;
    document.getElementById('time').innerHTML = time.toFixed(2);
    var energy = system.getEnergy();
    document.getElementById('kinetic').innerHTML = energy.kinetic.toFixed(2);
    document.getElementById('potential').innerHTML = energy.potential.toFixed(2);
    document.getElementById('total').innerHTML = (energy.kinetic + energy.potential).toFixed(2);
}

function start() {
    initSystem();
    animate();
}

start();
    </script>
  </body>
</html>
